(in-package :stumpwm)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; stumpwm config
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
(setf *shell-program* "/bin/zsh")

;; turn on/off the mode line for the current head only.
(toggle-mode-line (stumpwm:current-screen)
                  (stumpwm:current-head))

(setf *window-format* " %c ")
(setf *screen-mode-line-format*
      (list "%W | "
            '(:eval (run-shell-command "TZ='Asia/Tokyo' date +\"%H:%M\" " t))))

(set-prefix-key (kbd "C-q"))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; some useful commands
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(defcommand screenshot (filename) ((:rest "Filename: "))
  (run-shell-command
   (format nil "import ~a/screenshots/~a" (user-homedir-pathname) filename)))

(defcommand chrome () ()
  "Start google-chrome or switch to it, if it is already running."
  (run-or-raise "google-chrome" '(:class "google-chrome")))

(defcommand firefox () ()
  "Start Firefox or switch to it, if it is already running."
  (run-or-raise "firefox" '(:class "Firefox")))

(defcommand urxvt () ()
  "Start an urxvt instance or switch to it, if it is already running."
  (run-or-raise "urxvtc" '(:instance "urxvt")))

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; keyboard shortcuts
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

(define-key *root-map* (kbd "Print") "screenshot")
(define-key *root-map* (kbd "c") "chrome")
(define-key *root-map* (kbd "f") "firefox")
(define-key *root-map* (kbd "t") "urxvt")
